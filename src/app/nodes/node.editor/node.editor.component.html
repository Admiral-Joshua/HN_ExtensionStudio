<h1 mat-dialog-title>{{nodeId > 0 ? 'Editing' : 'Create New'}} {{nodeForm.get('name').value.length > 0 ? nodeForm.get('name').value : 'Computer'}}</h1>
<div mat-dialog-content>
    <mat-expansion-panel expanded>
        <mat-expansion-panel-header>
            <mat-panel-title>
                Basics and Security
            </mat-panel-title>
            <mat-panel-description>
                Define what this computer is, and it's level of security.
            </mat-panel-description>
        </mat-expansion-panel-header>

        <form [formGroup]="nodeForm">
            <mat-form-field class="half-field">
                <mat-label>ID:</mat-label>
                <input matInput placeholder="Short and snappy. E.g. dave-pc-01" formControlName="id" required minlength="3" />
            </mat-form-field>
            <mat-form-field class="half-field">
                <mat-label>Display Name:</mat-label>
                <input matInput placeholder="E.g. Dave's PC" formControlName="name" required />
            </mat-form-field>
            <mat-form-field class="third-field">
                <mat-label>IP Address:</mat-label>
                <input matInput placeholder="#RANDOM_IP#" formControlName="ip" pattern="(?:[0-9]{1,3}\.){3}[0-9]{1,3}" />
            </mat-form-field>
            <mat-form-field class="third-field">
                <mat-label>Icon:</mat-label>
                <mat-select formControlName="icon">
                    <mat-option *ngFor="let icon of supportedIcons" [value]="icon.icon" required>{{icon.name}}</mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field class="third-field">
                <mat-label>Computer Type:</mat-label>
                <mat-select formControlName="typeId">
                    <mat-option *ngFor="let type of supportedTypes" [value]="type.typeId" required>{{type.typeText}}</mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field class="full-field">
                <mat-label>Admin Password:</mat-label>
                <input matInput placeholder="xxxPass5w0rd!xxx" formControlName="adminPass" minlength="4" maxlength="24" />
            </mat-form-field>
            <mat-form-field class="third-field">
                <mat-label>Security Level:</mat-label>
                <input matInput placeholder="How secure is this computer?" formControlName="securityLevel" type="number" min="0" max="7" />
            </mat-form-field>
            <mat-form-field class="third-field">
                <mat-label>Ports for Crack:</mat-label>
                <input matInput placeholder="OPTIONAL: Overrides security level" formControlName="portsForCrack" type="number" min="0" max="9999" />
            </mat-form-field>
            <mat-form-field class="third-field">
                <mat-label>Trace Time (in seconds)</mat-label>
                <input matInput placeholder="Time the player has to get in and out of this node." formControlName="traceTime" type="number" min="-1" />
            </mat-form-field>
        </form>
    </mat-expansion-panel>
    <mat-expansion-panel>
        <mat-expansion-panel-header>
            <mat-panel-title>
                Ports
            </mat-panel-title>
            <mat-panel-description>
                Define what ports should be active on this node.
            </mat-panel-description>
        </mat-expansion-panel-header>
        <mat-form-field class="full-field">
            <mat-chip-list #chipList aria-label="Active Ports">
                <mat-chip *ngFor="let port of activePorts" selectable="false" removable="true" (removed)="removePort(port)" selected>
                    {{port.portType}}
                    <mat-icon matChipRemove>cancel</mat-icon>
                </mat-chip>
                <input matInput name="portSearch" placeholder="Add Port..." [formControl]="portSearch" [matAutocomplete]="auto" [matChipInputFor]="chipList">
            </mat-chip-list>
            <mat-autocomplete #auto="matAutocomplete" (optionSelected)="selected($event)" [displayWith]="displayNull">
                <mat-option *ngFor="let port of filteredPorts | async" [value]="port.portType">
                    {{port.portType}}
                </mat-option>
            </mat-autocomplete>
        </mat-form-field>
    </mat-expansion-panel>
    <mat-expansion-panel>
        <mat-expansion-panel-header>
            <mat-panel-title>
                Files
            </mat-panel-title>
            <mat-panel-description>
                Define what files should be listed on this node.
            </mat-panel-description>
        </mat-expansion-panel-header>
        <form>
            <h3>Add File</h3>
            <mat-form-field class="full-field">
                <label>From Template:</label>
                <mat-select (selectionChange)="addFile($event)">
                    <mat-option *ngFor="let template of fileTemplates" [value]="template">{{template.path}} - {{template.name}}</mat-option>
                </mat-select>
            </mat-form-field>
        </form>
        <h3>Files on Node:</h3>
        <mat-action-list>
            <div matRipple *ngFor="let file of files">
                <mat-icon>filter</mat-icon> /{{file.path}}/{{file.name}}
                <div class="float-right">
                    <button mat-flat-button color="accent">Edit</button>
                    <button mat-flat-button color="warn">Delete</button>
                </div>
            </div>
        </mat-action-list>
    </mat-expansion-panel>

</div>
<div mat-dialog-actions>
    <button mat-button color="warn" (click)="cancel()">Cancel</button>
    <button mat-flat-button color="primary" (click)="saveNode()">{{nodeId > 0 ? 'Save' : 'Create'}}</button>
</div>